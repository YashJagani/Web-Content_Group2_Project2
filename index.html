<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>D3.js Weather Temperature Chart</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fefefe;
      margin: 30px;
      text-align: center;
    }
    svg {
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .line {
      fill: none;
      stroke: steelblue;
      stroke-width: 2;
    }
    .axis-label {
      font-size: 14px;
    }
  </style>
</head>
<body>
  <h2>Temperature (°C) - Next 48 Hours</h2>
  <svg width="900" height="450"></svg>

  <script>
    const svg = d3.select("svg");
    const margin = { top: 40, right: 30, bottom: 60, left: 60 };
    const width = +svg.attr("width") - margin.left - margin.right;
    const height = +svg.attr("height") - margin.top - margin.bottom;
    const g = svg.append("g").attr("transform", `translate(${margin.left},${margin.top})`);

    fetch("https://api.open-meteo.com/v1/forecast?latitude=42.3001&longitude=-83.0165&hourly=temperature_2m&timezone=auto")
      .then(res => res.json())
      .then(data => {
        const times = data.hourly.time;
        const temps = data.hourly.temperature_2m;

        // Combine and parse time/temperature into objects
        const weatherData = times.map((t, i) => ({
          time: new Date(t),
          temp: temps[i]
        }));

        // Use only next 48 hours
        const slicedData = weatherData.slice(0, 48);

        const x = d3.scaleTime()
          .domain(d3.extent(slicedData, d => d.time))
          .range([0, width]);

        const y = d3.scaleLinear()
          .domain([d3.min(slicedData, d => d.temp) - 1, d3.max(slicedData, d => d.temp) + 1])
          .range([height, 0]);

        const line = d3.line()
          .x(d => x(d.time))
          .y(d => y(d.temp));

        // X Axis
        g.append("g")
          .attr("transform", `translate(0,${height})`)
          .call(d3.axisBottom(x).ticks(10).tickFormat(d3.timeFormat("%b %d %H:%M")))
          .selectAll("text")
          .attr("transform", "rotate(-40)")
          .style("text-anchor", "end");

        // Y Axis
        g.append("g").call(d3.axisLeft(y));

        // Y Axis label
        g.append("text")
          .attr("x", -height / 2)
          .attr("y", -45)
          .attr("transform", "rotate(-90)")
          .attr("text-anchor", "middle")
          .attr("class", "axis-label")
          .text("Temperature (°C)");

        // Line
        g.append("path")
          .datum(slicedData)
          .attr("class", "line")
          .attr("d", line);
      });
  </script>
</body>
</html> -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Rain vs Showers vs Snowfall - Pie Chart</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fefefe;
      text-align: center;
      margin: 30px;
    }
    .arc text {
      font-size: 14px;
      fill: #fff;
      text-anchor: middle;
    }
    .tooltip {
      position: absolute;
      background: white;
      border: 1px solid #ccc;
      padding: 6px 10px;
      font-size: 13px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      pointer-events: none;
      display: none;
    }
  </style>
</head>
<body>
  <h2>Rain vs Showers vs Snowfall (Next 48h)</h2>
  <svg width="500" height="500"></svg>
  <div class="tooltip"></div>

  <script>
    const svg = d3.select("svg"),
          width = +svg.attr("width"),
          height = +svg.attr("height"),
          radius = Math.min(width, height) / 2;

    const g = svg.append("g").attr("transform", `translate(${width/2},${height/2})`);
    const color = d3.scaleOrdinal(["#4A90E2", "#50E3C2", "#D0021B"]);
    const tooltip = d3.select(".tooltip");

    fetch("https://api.open-meteo.com/v1/forecast?latitude=42.3001&longitude=-83.0165&hourly=rain,showers,snowfall&timezone=auto")
      .then(res => res.json())
      .then(data => {
        const rain = data.hourly.rain.slice(0, 48).reduce((a, b) => a + b, 0);
        const showers = data.hourly.showers.slice(0, 48).reduce((a, b) => a + b, 0);
        const snowfall = data.hourly.snowfall.slice(0, 48).reduce((a, b) => a + b, 0);

        const pieData = [
          { label: "Rain", value: rain },
          { label: "Showers", value: showers },
          { label: "Snowfall", value: snowfall }
        ].filter(d => d.value > 0); // remove zero values for cleaner chart

        const pie = d3.pie().value(d => d.value);
        const arc = d3.arc().innerRadius(0).outerRadius(radius - 10);

        const arcs = g.selectAll(".arc")
          .data(pie(pieData))
          .enter().append("g")
          .attr("class", "arc");

        arcs.append("path")
          .attr("d", arc)
          .attr("fill", d => color(d.data.label))
          .on("mouseover", (event, d) => {
            tooltip.style("display", "block")
              .html(`<strong>${d.data.label}:</strong> ${d.data.value.toFixed(1)} mm`)
              .style("left", event.pageX + 10 + "px")
              .style("top", event.pageY - 30 + "px");
          })
          .on("mouseout", () => tooltip.style("display", "none"));

        arcs.append("text")
          .attr("transform", d => `translate(${arc.centroid(d)})`)
          .text(d => d.data.label);
      });
  </script>
</body>
</html>
